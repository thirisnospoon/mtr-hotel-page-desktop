(function($){function InitItemmap(item_map,key){var singleObj={};singleObj['type']='Feature';singleObj['geometry']={type:'Point',coordinates:[item_map.lng,item_map.lat]};singleObj['properties']={title:item_map.name,description:item_map.content_html,icon_mk:item_map.icon_mk,};return singleObj;}
var body='body.single';$('.st-map-box',body).each(function(){var parent=$(this),mapEl=$('.google-map-mapbox',parent);var mapData=mapEl.data('data_show');mapboxgl.accessToken=st_params.token_mapbox;if(typeof st_params.text_rtl_mapbox!=='underfind'){mapboxgl.setRTLTextPlugin(st_params.text_rtl_mapbox);}
var listOfObjects=[];jQuery.map(mapData,function(location,i){var item_map=InitItemmap(location,i);listOfObjects.push(item_map);});const geojson={'type':'FeatureCollection','features':listOfObjects};var map=new mapboxgl.Map({container:"st-map",style:"mapbox://styles/mapbox/streets-v10?optimize=true",zoom:mapEl.data().zoom,center:[mapEl.data().lng,mapEl.data().lat]});for(const marker of geojson.features){const el=document.createElement('div');el.className='marker';el.style.backgroundImage=`url(${marker.properties.icon_mk})`;el.style.backgroundSize='100%';el.style.backgroundRepeat='no-repeat';el.style.width='40px';el.style.height='50px';el.style.objectFit='contain';el.className='marker';const description=marker.properties.description;new mapboxgl.Marker(el).setLngLat(marker.geometry.coordinates).setPopup(new mapboxgl.Popup({offset:[150,150]}).setHTML(`${description}`)).addTo(map);}
$('#st-modal-show-map').on('shown.bs.modal',function(){map.resize();});});function initMapContactPage(mapEl){var mapLat=mapEl.data('lat');var mapLng=mapEl.data('lng');mapboxgl.accessToken=st_params.token_mapbox;var map=new mapboxgl.Map({container:"contact-mapbox-new",style:"mapbox://styles/mapbox/streets-v11?optimize=true",zoom:13,center:[mapLng,mapLat]});map.on("load",function(){map.loadImage("https://i.imgur.com/MK4NUzI.png",function(error,image){if(error)throw error;map.addImage("custom-marker",image);map.addLayer({id:"markers",type:"symbol",source:{type:"geojson",data:{type:'FeatureCollection',features:[{type:'Feature',properties:{},geometry:{type:"Point",coordinates:[mapLng,mapLat]}}]}},layout:{"icon-image":"custom-marker",}});});var mapCanvas=document.getElementsByClassName('mapboxgl-canvas')[0];mapCanvas.style.width='100%';mapCanvas.style.height='500px';map.resize();});}
if($('#contact-mapbox-new').length){initMapContactPage($('#contact-mapbox-new'));}})(jQuery);